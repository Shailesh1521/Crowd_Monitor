<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpotCheck App</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load React -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <!-- Load Babel to compile JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-slate-950">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- SVG Icons (Replacing lucide-react for standalone HTML) ---
        const MapIcon = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21"/><line x1="9" y1="3" x2="9" y2="18"/><line x1="15" y1="6" x2="15" y2="21"/></svg>;
        const PlusCircle = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>;
        const User = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>;
        const MapPin = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>;
        const Users = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>;
        const Award = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>;
        const Zap = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>;
        const CheckCircle2 = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>;
        const AlertTriangle = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>;
        const XCircle = ({ size=24, className="" }) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>;

        // --- INITIAL MOCK DATA ---
        const initialLocations = [
          { id: 1, name: "Main Library - 2nd Floor", status: "red", fill: 92, lastUpdated: "2 mins ago" },
          { id: 2, name: "Engineering Canteen", status: "yellow", fill: 65, lastUpdated: "15 mins ago" },
          { id: 3, name: "CS Lab 3 (RPA Hub)", status: "green", fill: 15, lastUpdated: "1 hr ago" },
          { id: 4, name: "Student Lounge", status: "red", fill: 100, lastUpdated: "Just now" },
          { id: 5, name: "Campus Gym", status: "yellow", fill: 50, lastUpdated: "45 mins ago" },
        ];

        const ranks = ["Campus Ghost", "Scout", "Pathfinder", "Local Legend", "Campus Oracle"];

        function App() {
          const [activeTab, setActiveTab] = useState('map');
          const [locations, setLocations] = useState(initialLocations);
          const [user, setUser] = useState({ xp: 0, level: 1, contributions: 0 });
          const [showXpPopup, setShowXpPopup] = useState(false);

          // Calculate rank based on level
          const currentRank = ranks[Math.min(user.level - 1, ranks.length - 1)];
          const xpNeeded = user.level * 50; 

          const handleReport = (locationId, newStatus) => {
            // 1. Update Location Data
            let newFill = 0;
            if (newStatus === 'green') newFill = Math.floor(Math.random() * 30); 
            if (newStatus === 'yellow') newFill = Math.floor(Math.random() * 30) + 40; 
            if (newStatus === 'red') newFill = Math.floor(Math.random() * 20) + 80; 

            setLocations(prev => prev.map(loc => 
              loc.id === locationId 
                ? { ...loc, status: newStatus, fill: newFill, lastUpdated: "Just now" } 
                : loc
            ));

            // 2. Gamification: Award XP
            const earnedXp = 15;
            let newXp = user.xp + earnedXp;
            let newLevel = user.level;

            if (newXp >= xpNeeded) {
              newLevel += 1;
              newXp = newXp - xpNeeded;
            }

            setUser(prev => ({
              xp: newXp,
              level: newLevel,
              contributions: prev.contributions + 1
            }));

            // 3. Show Feedback
            setShowXpPopup(true);
            setTimeout(() => setShowXpPopup(false), 2000);
            setActiveTab('map'); 
          };

          const StatusColor = {
            green: "text-emerald-400 bg-emerald-400/10 border-emerald-400/20",
            yellow: "text-amber-400 bg-amber-400/10 border-amber-400/20",
            red: "text-rose-400 bg-rose-400/10 border-rose-400/20",
          };

          const BarColor = {
            green: "bg-emerald-400",
            yellow: "bg-amber-400",
            red: "bg-rose-400",
          };

          return (
            <div className="min-h-screen bg-slate-950 text-slate-200 font-sans flex justify-center">
              <div className="w-full max-w-md bg-slate-900 shadow-2xl overflow-hidden flex flex-col relative border-x border-slate-800 h-screen">
                
                {/* Header */}
                <header className="bg-slate-950 p-4 border-b border-slate-800 flex justify-between items-center z-10 shrink-0">
                  <div>
                    <h1 className="text-xl font-bold bg-gradient-to-r from-indigo-400 to-cyan-400 bg-clip-text text-transparent flex items-center gap-2">
                      <MapPin size={24} className="text-indigo-400" />
                      SpotCheck
                    </h1>
                    <p className="text-xs text-slate-400">Live Campus Heatmap</p>
                  </div>
                  <div className="flex flex-col items-end">
                    <span className="text-sm font-bold text-indigo-300">Lvl {user.level}</span>
                    <div className="w-16 h-1.5 bg-slate-800 rounded-full mt-1 overflow-hidden">
                      <div 
                        className="h-full bg-gradient-to-r from-indigo-500 to-cyan-400 transition-all duration-500"
                        style={{ width: `${(user.xp / xpNeeded) * 100}%` }}
                      />
                    </div>
                  </div>
                </header>

                {/* Floating XP Popup */}
                {showXpPopup && (
                  <div className="absolute top-20 left-1/2 transform -translate-x-1/2 bg-indigo-500 text-white px-4 py-2 rounded-full font-bold shadow-lg flex items-center gap-2 animate-bounce z-50">
                    <Zap size={16} /> +15 XP Earned!
                  </div>
                )}

                {/* Main Content Area */}
                <main className="flex-1 overflow-y-auto p-4 hide-scrollbar pb-24">
                  
                  {/* TAB 1: LIVE HEATMAP */}
                  {activeTab === 'map' && (
                    <div className="space-y-4 duration-300">
                      <h2 className="text-sm font-semibold text-slate-400 uppercase tracking-wider mb-2 flex items-center gap-2">
                        <Users size={16} /> Live Status
                      </h2>
                      
                      {locations.map((loc) => (
                        <div key={loc.id} className="bg-slate-800/50 rounded-xl p-4 border border-slate-700/50 hover:border-indigo-500/30 transition-colors">
                          <div className="flex justify-between items-start mb-3">
                            <h3 className="font-medium text-slate-100">{loc.name}</h3>
                            <span className={`text-xs px-2 py-1 rounded-md border font-semibold flex items-center gap-1 ${StatusColor[loc.status]}`}>
                              {loc.status === 'green' && "Empty"}
                              {loc.status === 'yellow' && "Moderate"}
                              {loc.status === 'red' && "Packed"}
                            </span>
                          </div>
                          
                          <div className="w-full h-2 bg-slate-950 rounded-full overflow-hidden mb-2">
                            <div 
                              className={`h-full transition-all duration-1000 ease-out ${BarColor[loc.status]}`} 
                              style={{ width: `${loc.fill}%` }}
                            />
                          </div>
                          
                          <div className="flex justify-between text-xs text-slate-500">
                            <span>{loc.fill}% Capacity</span>
                            <span>Updated: {loc.lastUpdated}</span>
                          </div>
                        </div>
                      ))}
                    </div>
                  )}

                  {/* TAB 2: CROWDSOURCING (REPORT) */}
                  {activeTab === 'report' && (
                    <div className="space-y-6 duration-300">
                      <div className="text-center space-y-2 mt-4">
                        <div className="inline-block p-3 bg-indigo-500/20 rounded-full text-indigo-400 mb-2">
                          <MapPin size={32} />
                        </div>
                        <h2 className="text-xl font-bold">Where are you?</h2>
                        <p className="text-sm text-slate-400">Update the crowd status to earn XP.</p>
                      </div>

                      <div className="space-y-4">
                        {locations.map(loc => (
                          <div key={`report-${loc.id}`} className="bg-slate-800/50 rounded-xl p-4 border border-slate-700/50">
                            <h3 className="font-medium mb-3">{loc.name}</h3>
                            <div className="grid grid-cols-3 gap-2">
                              <button 
                                onClick={() => handleReport(loc.id, 'green')}
                                className="flex flex-col items-center gap-1 p-2 rounded-lg bg-slate-900 border border-emerald-500/30 hover:bg-emerald-500/20 transition-colors text-emerald-400"
                              >
                                <CheckCircle2 size={24} />
                                <span className="text-xs font-semibold">Empty</span>
                              </button>
                              <button 
                                onClick={() => handleReport(loc.id, 'yellow')}
                                className="flex flex-col items-center gap-1 p-2 rounded-lg bg-slate-900 border border-amber-500/30 hover:bg-amber-500/20 transition-colors text-amber-400"
                              >
                                <AlertTriangle size={24} />
                                <span className="text-xs font-semibold">Moderate</span>
                              </button>
                              <button 
                                onClick={() => handleReport(loc.id, 'red')}
                                className="flex flex-col items-center gap-1 p-2 rounded-lg bg-slate-900 border border-rose-500/30 hover:bg-rose-500/20 transition-colors text-rose-400"
                              >
                                <XCircle size={24} />
                                <span className="text-xs font-semibold">Packed</span>
                              </button>
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>
                  )}

                  {/* TAB 3: PROFILE & GAMIFICATION */}
                  {activeTab === 'profile' && (
                    <div className="space-y-6 duration-300 mt-4">
                      <div className="bg-gradient-to-br from-indigo-900/50 to-slate-900 rounded-2xl p-6 border border-indigo-500/30 text-center relative overflow-hidden">
                        <div className="absolute top-0 right-0 p-4 opacity-10">
                          <Award size={100} />
                        </div>
                        
                        <div className="inline-block p-4 bg-slate-950 rounded-full border-2 border-indigo-400 mb-4 shadow-[0_0_15px_rgba(99,102,241,0.5)]">
                          <User size={40} className="text-indigo-400" />
                        </div>
                        
                        <h2 className="text-2xl font-bold text-white mb-1">{currentRank}</h2>
                        <p className="text-indigo-300 font-medium mb-6">Level {user.level} Contributor</p>
                        
                        <div className="bg-slate-950/50 rounded-xl p-4 text-left">
                          <div className="flex justify-between text-sm mb-2">
                            <span className="text-slate-400">Progress to Lvl {user.level + 1}</span>
                            <span className="font-bold text-indigo-400">{user.xp} / {xpNeeded} XP</span>
                          </div>
                          <div className="w-full h-3 bg-slate-800 rounded-full overflow-hidden">
                            <div 
                              className="h-full bg-gradient-to-r from-indigo-500 to-cyan-400"
                              style={{ width: `${(user.xp / xpNeeded) * 100}%` }}
                            />
                          </div>
                        </div>
                      </div>

                      <div className="grid grid-cols-2 gap-4">
                        <div className="bg-slate-800/50 rounded-xl p-4 border border-slate-700/50 flex flex-col items-center text-center">
                          <span className="text-3xl font-bold text-emerald-400 mb-1">{user.contributions}</span>
                          <span className="text-xs text-slate-400">Total Updates</span>
                        </div>
                        <div className="bg-slate-800/50 rounded-xl p-4 border border-slate-700/50 flex flex-col items-center text-center">
                          <span className="text-3xl font-bold text-amber-400 mb-1">{user.contributions * 15}</span>
                          <span className="text-xs text-slate-400">Total XP Earned</span>
                        </div>
                      </div>

                    </div>
                  )}

                </main>

                {/* Bottom Navigation */}
                <nav className="absolute bottom-0 w-full bg-slate-950/90 backdrop-blur-md border-t border-slate-800 pb-safe z-20 shrink-0">
                  <div className="flex justify-around items-center p-2">
                    <button 
                      onClick={() => setActiveTab('map')}
                      className={`flex flex-col items-center p-2 w-20 transition-colors ${activeTab === 'map' ? 'text-indigo-400' : 'text-slate-500 hover:text-slate-300'}`}
                    >
                      <MapIcon size={24} className="mb-1" />
                      <span className="text-[10px] font-medium">Heatmap</span>
                    </button>
                    
                    <button 
                      onClick={() => setActiveTab('report')}
                      className="flex flex-col items-center justify-center transform -translate-y-4"
                    >
                      <div className={`p-4 rounded-full shadow-lg transition-transform ${activeTab === 'report' ? 'bg-indigo-500 scale-110 shadow-indigo-500/50' : 'bg-slate-800 border-2 border-indigo-500 text-indigo-400 hover:scale-105'}`}>
                        <PlusCircle size={28} className={activeTab === 'report' ? 'text-white' : ''} />
                      </div>
                      <span className={`text-[10px] font-medium mt-1 ${activeTab === 'report' ? 'text-indigo-400' : 'text-slate-500'}`}>Update</span>
                    </button>

                    <button 
                      onClick={() => setActiveTab('profile')}
                      className={`flex flex-col items-center p-2 w-20 transition-colors ${activeTab === 'profile' ? 'text-indigo-400' : 'text-slate-500 hover:text-slate-300'}`}
                    >
                      <User size={24} className="mb-1" />
                      <span className="text-[10px] font-medium">Profile</span>
                    </button>
                  </div>
                </nav>
                
              </div>
            </div>
          );
        }

        // Render the App
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>